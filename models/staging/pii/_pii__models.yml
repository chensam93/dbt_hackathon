version: 2

models:
  - name: stg_pii__tag_pii_snowflake
    config:
      materialized: table
      pre-hook:
        # Create the PII tags w/ allowed values
        sql:  use schema hackathon.coffee_shop;
              create tag if not exists TABLE_PII_FLAG allowed_values 'Yes' , 'No';
              create tag if not exists COLUMN_PII_TYPE_SNOWFLAKE allowed_values 'EMAIL', 'IBAN', 'IMEI', 'IP_ADDRESS', 'VIN', 'NAME', 'PAYMENT_CARD', 
                'PHONE_NUMBER', 'URL', 'US_BANK_ACCOUNT', 'US_DRIVERS_LICENSE', 'US_PASSPORT', 'US_SSN', 'US_STREET_ADDRESS', 'AGE', 'GENDER', 
                'COUNTRY', 'DATE_OF_BIRTH', 'ETHNICITY', 'LATITUDE', 'LAT_LONG', 'LONGITUDE', 'MARITAL_STATUS', 'OCCUPATION', 'US_POSTAL_CODE', 
                'US_STATE_OR_TERRITORY', 'US_COUNTY', 'US_CITY', 'YEAR_OF_BIRTH', 'SALARY';
        transaction: true

      packages:
        - pandas
      # imports:
        # - "@OTHER_PYTHON_PACKAGES/wheel_loader.py"
        # - "@OTHER_PYTHON_PACKAGES/piicatcher-0.19.2-py3-none-any.whl"
        # - "@OTHER_PYTHON_PACKAGES/piicatcher_spacy-0.1.1-py3-none-any.whl"

  - name: stg_pii__tag_pii_catcher
    config:
      materialized: table
      pre-hook:
        # Create the PII tags w/ allowed values
        sql:  use schema hackathon.coffee_shop;
              create tag if not exists TABLE_PII_FLAG allowed_values 'Yes' , 'No';
              create tag if not exists COLUMN_PII_TYPE_PIICATCHER allowed_values 'Phone', 'Email', 'Credit Card', 'Address', 'Person', 'Location', 'Date', 
                'Gender', 'Nationality', 'IP Address', 'SSN', 'User Name', 'Password';
        transaction: true

      packages:
        - pandas
      imports:
        - "@OTHER_PYTHON_PACKAGES/wheel_loader.py"
        - "@OTHER_PYTHON_PACKAGES/piicatcher-0.19.2-py3-none-any.whl"
        - "@OTHER_PYTHON_PACKAGES/piicatcher_spacy-0.1.1-py3-none-any.whl"
